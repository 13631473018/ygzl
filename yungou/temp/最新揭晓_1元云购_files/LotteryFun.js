var resetLotteryListStyle=null;var bindLotteryItemHover=null;$(document).ready(function(){var a="http://skin.1yyg.com";var b=function(){var g=$("#divLoading");var h=$("#divLottery");var m=$("#lotteryCount");var n=$("#divMsg");var d=$("#divPage");var e=parseInt($("#hidCurPage").val());var o=parseInt($("#hidCurSortID").val());var j=",";var i=72;var c=function(){var p=(e-1)*i+1;var s=p+i-1;var r=0;var q=function(){return"FIdx="+p+"&EIdx="+s+"&SortID="+o+"&IsCount=1"};var t=function(){GetJPData("http://api.1yyg.com","getLotteryList",q(),function(F){if(F.code==0){r=F.totalCount;_PageCount=r%i==0?r/i:parseInt(r/i)+1;var D=function(G){return _LotteryPage="/lottery/"+G+".html"};var C=function(G){return"http://u.1yyg.com/"+G};g.hide();h.show();var x=F.listItems;var A="";for(var y=0;y<x.length;y++){if(y<i/2){j+=x[y].codeID+","}A='<div type="isRaff" class="m-lottery-list'+((y+1)%3==0?" m-lottery-special":"")+'"><ul><li class="f-lott-comm"><a href="'+D(x[y].codeID)+'" target="_blank" title="'+x[y].goodsName+'"><img src2="http://goodsimg.1yyg.com/GoodsPic/pic-200-200/'+x[y].goodsPic+'"></a>'+(x[y].codeType==3?'<i class="F_goods_xg transparent-png">限购</i>':"")+'</li><li class="f-lott-detailed"><div class="u-user-info"><p class="fl"><a href="'+C(x[y].userWeb)+'" target="_blank" title="'+x[y].userName+'"><img type="userPhoto" src2="http://faceimg.1yyg.com/UserFace/'+x[y].userPhoto+'"><s></s></a></p><dl class="fl"><dt><em>获得者：</em><span><a href="'+C(x[y].userWeb)+'" target="_blank" title="'+x[y].userName+'">'+x[y].userName+'</a></span></dt><dd class="z-lott-lz">来自：'+x[y].userAddr+'</dd><dd>幸运云购码：<strong class="orange">'+x[y].userRNO+'</strong></dd><dd>本云参与：<i class="orange">'+x[y].userBuyNum+'</i>人次</dd></dl></div><div class="u-comm-info"><dl><dt><a href="'+D(x[y].codeID)+'" target="_blank" title="(第'+x[y].codePeriod+"云)"+x[y].goodsName+'">(第'+x[y].codePeriod+"云)"+x[y].goodsName+"</a></dt><dd>商品价值：￥"+x[y].codePrice+"</dd><dd>揭晓时间："+x[y].raffTime+'</dd><dd class="z-lott-btn"><span><a href="'+D(x[y].codeID)+'" target="_blank" title="查看详情">查看详情</a></span>'+(x[y].postID==0?"":'<p><em>已晒单</em><a href="http://post.1yyg.com/detail-'+x[y].postID+'.html" target="_blank" title="查看">查看</a><cite><i></i></cite></p>')+"</dd></dl></div></li></ul></div>";h.append(A)}if(r>i){var E=l(r,i,e,5,u);d.html(E).show();var v=$("#btnGotoPage");var w=v.parent().prev().find("input");var B=function(){var G=parseInt(w.val());if(G>0){if(G>_PageCount){G=_PageCount}window.location.href=u(G)}return false};var z=1;w.keyup(function(H){var I=H||window.event||arguments.callee.caller.arguments[0];if(I){if(I.keyCode==13){B()}else{var G=$(this).val();if(!(/^\d+$/.test(G))){$(this).val(z)}else{z=G;$(this).val(G)}}}}).mouseover(function(){$(this).focus().select()});v.click(function(){B();return false})}else{d.empty().hide()}f();if(o==0&&e==1){k()}loadImgFun()}else{if(F.code==1){g.hide();n.html("此分类下暂无揭晓商品记录 !").show()}else{g.hide();n.append("抱歉，加载记录失败了 ! 请刷新试试 !").show()}}})};var u=function(w){var v="/lottery/";if(o>0){v+="i"+o}v+="m"+w;v+=".html";return v};t()};bindLotteryItemHover=function(p){p.hover(function(){var q=parseInt(h.children("div").index($(this)[0]))+1;if(q%3==0){$(this).addClass("m-lottery-hover m-lottery-hover2")}else{$(this).addClass("m-lottery-hover")}},function(){var q=parseInt(h.children("div").index($(this)[0]))+1;if(q%3==0){$(this).removeClass("m-lottery-hover m-lottery-hover2")}else{$(this).removeClass("m-lottery-hover")}})};var f=function(){h.children('div[type="isRaff"]').each(function(){bindLotteryItemHover($(this))})};c();resetLotteryListStyle=function(){var p=h.children("div.m-lottery-list");p.each(function(){$(this).removeClass("m-lottery-special");var q=parseInt(p.index($(this)[0]))+1;if(q%3==0){$(this).addClass("m-lottery-special")}})};var l=function(v,u,x,y,q){var r=1,w=1,t=1;var p="";r=parseInt(v/u);if(v%u>0){r++}if(r<1){r=1}p+="<div>";if(v>0){w=1;while(w+y<r+1&&w+y<x+2){w+=y-2}t=w+y-1;if(t>r){t=r}if(x==1){p+='<span class="f-noClick"><a href="javascript:;"><i class="f-tran f-tran-prev">&lt;</i>上一页</a></span>'}else{p+='<span><a title="上一页" href="'+q(x-1)+'"><i class="f-tran f-tran-prev">&lt;</i>上一页</a></span>'}if(w>1){p+='<span><a href="'+q(1)+'">1</a></span><span>…</span>'}for(var s=w;s<=t;s++){if(s!=x){p+='<span><a href="'+q(s)+'">'+s+"</a></span>"}else{p+='<span class="current"><a>'+s+"</a></span>"}}if(t<r){p+='<span>…</span><span><a href="'+q(r)+'">'+r+"</a></span>"}if(x<r){p+='<span><a href="'+q(x+1)+'" title="下一页">下一页<i class="f-tran f-tran-next">&gt;</i></a></span>'}else{p+='<span class="f-noClick"><a>下一页<i class="f-tran f-tran-next">&gt;</i></a></span>'}}p+='<span class="f-mar-left">共<em>'+r+"</em>页，去第</span>";p+='<span><input type="text" value="'+x+'" maxlength="6">页</span>';p+='<span class="f-mar-left"><a id="btnGotoPage" href="javascript:;" title="确定">确定</a></span>';p+="</div>";return p};var k=function(){var s=false;var t=0;var p=function(u){return"/product/"+u+".html"};var r=(function(v){if(v.errorCode==0){t=v.maxSeconds;var u=function(y){for(var x=y.length-1;x>-1;x--){if(j!=""&&j.indexOf(","+y[x].codeID+",")>-1){j="";continue}var z='<div class="m-lottery-list m-lottery-anning"><ul><li class="f-lott-comm"><a href="'+p(y[x].codeID)+'" target="_blank" title="'+y[x].goodsSName+'"><img src="http://goodsimg.1yyg.com/goodspic/pic-200-200/'+y[x].goodsPic+'"></a>'+(y[x].codeType==3?'<i class="F_goods_xg transparent-png">限购</i>':"")+'</li><li class="f-lott-detailed"><dl><dt><a href="'+p(y[x].codeID)+'" target="_blank" title="(第'+y[x].period+"云)"+y[x].goodsSName+'">(第'+y[x].period+"云)"+y[x].goodsSName+"</a></dt><dd>商品价值：￥"+y[x].price+'</dd><dd class="z-ymy">已满员</dd><dd class="z-jx-time"><p>揭晓倒计时</p><cite><span class="minute">00</span><em>:</em><span class="second">00</span><em>:</em><span><i class="millisecond">0</i><i class="last">0</i></span></cite></dd></dl></li></ul><b class="transparent-png"></b></div>';var w=$(z);h.prepend(w);w.StartTimeOut(y[x].codeID,parseInt(y[x].seconds))}resetLotteryListStyle();h.children("div:gt("+(i-1)+")").remove()};if(s){u(v.listItems)}else{Base.getScript(a+"/DataServer/JS/LotteryTime.js?date=150602",function(){s=true;u(v.listItems)})}}setTimeout(q,5000)});var q=function(){GetJPData("http://api.1yyg.com","GetStartRaffleAllList","time="+t,r)};q()}};Base.getScript(a+"/JS/AjaxFun.js?date=20130123",b)});